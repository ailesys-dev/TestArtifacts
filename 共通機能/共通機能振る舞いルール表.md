# AllCampus 共通機能振る舞いルール表

## 1. 概要

本ドキュメントは、AllCampus プロジェクトにおける共通機能の標準的な振る舞いを定義するものである。
画面個別の仕様書に記載がない場合、本ドキュメントの定義を「正」として扱う。

## 2. ルール一覧

### 必須項目

**Scenario: 必須項目の表示**

- **Given** 入力項目が必須である
- **Then** ラベルの背景色が赤くなっている状態で表示される

**Scenario: 未入力時のバリデーション**

- **Given** 必須項目が未入力である
- **When** 検索等の次へ進む操作を行う
- **Then** 項目下に赤文字でエラーメッセージが表示される
- **And** 画面右上にエラーがトースト表示される

### 検索ボタン

**Scenario: 検索実行時の挙動**

- **Given** 検索ボタンが表示されている
- **When** 検索ボタンを押下する
- **Then** 画面が暗転し、キャンセルボタン付きのローディング（スピナー）が表示される
- **And** 処理中はキャンセルボタン以外が入力できない状態になる（二重送信防止）

**Scenario: 検索結果が存在する場合**

- **Given** 検索条件に一致するデータが存在する
- **When** 検索を実行する
- **Then** 検索条件と一致する検索結果が表示される(DB 等で同等の条件と照らし合わせて確認する)

**Scenario: 検索結果が 0 件の場合**

- **Given** 検索条件に一致するデータが存在しない
- **When** 検索を実行する
- **Then** 「該当するデータがありません」というメッセージが表示される(DB 等で同等の条件と照らし合わせて確認する)

### 条件クリアボタン

**Scenario: 検索条件のクリア**

- **Given** 条件クリアボタンが表示され、検索条件が設定されている
- **When** 条件クリアボタンを押下する
- **Then** 検索条件が初期値に戻る

### 〇〇検索ボタン

**Scenario: 〇〇検索モーダル表示**

- **Given** 〇〇検索ボタンが表示されている
- **When** 〇〇検索ボタンを押下する
- **Then** 〇〇検索モーダルが表示される

### 削除ボタン

**Scenario: 削除確認**

- **Given** 削除ボタンが表示されている
- **When** 削除ボタンを押下する
- **Then** 警告の確認モーダルが表示される
- **And** モーダルには「削除してよろしいですか？」というメッセージが表示される
- **And** 「はい」ボタンで削除が実行される
- **And** 「いいえ」ボタンでキャンセルされる

**Scenario: 削除不可データの削除試行**

- **Given** 削除対象のデータが削除不可（紐づきあり等）である
- **When** 削除を試みる
- **Then** エラーメッセージが表示される

### 登録ボタン

**Scenario: 登録確認**

- **Given** 登録ボタンが表示されている
- **When** 登録ボタンを押下する
- **Then** 登録の確認モーダルが表示される
- **And** モーダルには登録を確認する旨のメッセージが表示される
- **And** 「はい」ボタンで登録が実行される
  - **And** 画面が暗転し、キャンセルボタン付きのローディング（スピナー）が表示される
  - **And** 処理中はキャンセルボタン以外が入力できない状態になる（二重送信防止）
  - **And** 処理後は登録の成否に応じたメッセージが表示される
- **And** 「いいえ」ボタンでキャンセルされる

**Scenario: 登録不可データの登録試行**

- **Given** 登録対象のデータが登録不可（データの重複等）である
- **When** 登録を試みる
- **Then** エラーメッセージが表示される

### 中止ボタン

**Scenario: 中止確認**

- **Given** 中止ボタンが表示されている
- **When** 中止ボタンを押下する
- **Then** 中止の確認モーダルが表示される
- **And** モーダルには「入力を中止しますか？」というメッセージが表示される
- **And** 「はい」ボタンで入力情報の破棄、検索結果一覧のクリア、検索前の活性状態への切り替えが行われる
- **And** 「いいえ」ボタンでキャンセルされる

### ファイル出力ボタン（単独）

**Scenario: ファイル出力モーダル表示**

- **Given** ファイル出力ボタンが表示されている
- **When** ファイル出力ボタンを押下する
- **Then** ファイル出力モーダルが表示される

**Scenario: 出力対象が未選択である場合**

- **Given** 出力対象が選択されていない、または存在しない
- **When** ファイル出力ボタンを押下する
- **Then** 「ファイル出力するデータが選択されていません。」というトーストメッセージが表示される

**Scenario: 出力設定にエラーがある場合**

- **Given** 出力設定の入力項目が存在し、エラーが発生している
- **When** ファイル出力ボタンを押下する
- **Then** 出力設定に誤りがある旨のトーストメッセージが表示される

### ファイル出力ボタン（ファイルパス事前指定）

**Scenario: ファイル出力**

- **Given** ファイル出力ボタンが表示されている
- **When** ファイル出力ボタンを押下する
- **Then** ファイル出力の確認モーダルが表示される
- **And** モーダルには「ファイルを出力します。よろしいですか？」というメッセージが表示される
- **And** 「はい」ボタンでファイル出力が実行される
  - **And** 画面が暗転し、キャンセルボタン付きのローディング（スピナー）が表示される
  - **And** 処理中はキャンセルボタン以外が入力できない状態になる（二重送信防止）
  - **And** 処理後はファイル出力の成否に応じたメッセージが表示される
- **And** 「いいえ」ボタンでキャンセルされる

**Scenario: ファイルパスにエラーがある場合**

- **Given** ファイルパステキストボックスにてエラーが発生している
- **When** ファイル出力ボタンを押下する
- **Then** エラーの種類に応じたメッセージのエラーモーダルが表示される

### 表示順ドロップダウンリスト

**Scenario: 表示順変更**

- **Given** 表示順ドロップダウンリストが表示されている
- **When** 表示順を変更する
- **Then** 検索結果が指定した表示順に変更される

**Scenario: 表示順指定後の検索実行**

- **Given** 表示順ドロップダウンリストで表示順を指定している
- **When** 検索を実行する
- **Then** 検索結果が指定した表示順で表示される

### ファイル出力モーダル

**Scenario: ファイル出力**

- **Given** ファイル出力モーダルが表示されている
- **When** ファイルパスを入力し、開始ボタンを押下する
- **Then** 画面が暗転し、キャンセルボタン付きのローディング（スピナー）が表示される
- **And** 処理中はキャンセルボタン以外が入力できない状態になる（二重送信防止）
- **And** 処理後はファイル出力の成否に応じたメッセージが表示される

**Scenario: ファイルパスにエラーがある場合**

- **Given** ファイルパステキストボックスにてエラーが発生している
- **When** 開始ボタンを押下する
- **Then** エラーの種類に応じたメッセージのエラーモーダルが表示される

## 3. 運用について

- ここに記載するルールは、その機能の目的そのものであり、UI/UX は考慮しないものとする。
- 新たな共通パターンが発生した場合は、本ドキュメントを更新し周知すること。
